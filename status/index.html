<!DOCTYPE html>
<html lang="en" x-data="domainMonitor()" x-init="loadStatus()">
<head>
  <meta charset="UTF-8">
  <title>Domain Monitor</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body class="bg-gray-900 text-gray-50 px-6 flex flex-col min-h-screen">

<div class="max-w-5xl w-full mx-auto space-y-10">

  <!-- Header -->
  <div class="pt-20 flex flex-col items-center">
    <span class="mx-auto inline-flex items-center justify-center rounded-full bg-emerald-100 dark:bg-emerald-400/20 dark:to-emerald-500/10">
      <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor" class="text-emerald-500"><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22ZM17.4571 9.45711L11 15.9142L6.79289 11.7071L8.20711 10.2929L11 13.0858L16.0429 8.04289L17.4571 9.45711Z"></path></svg>
    </span>
    <h1 class="mt-3 text-lg font-semibold text-gray-900 dark:text-gray-50">All services are online</h1>
    <p class="text-sm text-gray-700 dark:text-gray-300">Last updated on <span x-text="lastUpdated"></span></p>
  </div>

  <!-- Domain Status Accordion -->
  <div class="container mx-auto p-6">
    <template x-for="(domain, idx) in domains" :key="idx">
      <div class="relative w-full rounded-lg border p-6 text-left shadow-sm bg-white dark:bg-[#090E1A] border-gray-200 dark:border-gray-900 space-y-3">

        <!-- Header -->
        <h3>
          <button type="button"
                  @click="domain.open = !domain.open"
                  class="group flex flex-1 cursor-pointer items-center justify-between py-3 text-left focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500 h-12 rounded-lg bg-gray-100 px-4 text-sm font-medium text-gray-900 hover:bg-gray-100/70 dark:bg-gray-800 dark:text-gray-50 hover:dark:bg-gray-800/70">
            <div class="flex w-full items-center justify-between">
              <span x-text="domain.domain"></span>
              <span class="mr-6 flex items-center space-x-1" :class="domain.http_ok ? 'text-emerald-600 dark:text-emerald-500' : 'text-red-600'">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor" class="shrink-0">
                  <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22ZM17.4571 9.45711L11 15.9142L6.79289 11.7071L8.20711 10.2929L11 13.0858L16.0429 8.04289L17.4571 9.45711Z"></path>
                </svg>
                <span class="text-sm" x-text="domain.http_ok ? 'Operational' : 'Down'"></span>
              </span>
            </div>
          </button>
        </h3>

        <!-- Panel -->
        <div x-show="domain.open" x-transition class="mt-2 px-4 pb-4 text-sm text-gray-700 dark:text-gray-200 space-y-1">

          <div class="flex gap-4 justify-between">
            <h3 class="mt-2 text-lg font-medium text-gray-900 dark:text-gray-50">
              <a :href="`http://${domain.domain}`" target="_blank" x-text="domain.domain" class="relative border-b-2 border-transparent hover:border-gray-900 dark:hover:border-gray-50 transition-all duration-300"></a>
            </h3>
            <a :href="`domain.html?domain=${domain.domain}`" class="inline-flex items-center justify-center px-3 py-2 text-sm font-medium border rounded-md shadow-sm bg-white dark:bg-gray-950 text-gray-900 dark:text-gray-50 hover:bg-gray-50 dark:hover:bg-gray-900/60">View Detailed Data</a>
          </div>

          <!-- Info badges -->
          <div class="mt-4 flex flex-wrap items-center gap-2 text-xs">
            <span class="inline-flex items-center gap-1.5 rounded-md bg-gray-100 px-2.5 py-1 text-gray-600 dark:bg-gray-800 dark:text-gray-400">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                <path d="M18.364 17.364L12 23.728 5.636 17.364C2.121 13.849 2.121 8.151 5.636 4.636 9.151 1.121 14.849 1.121 18.364 4.636 21.879 8.151 21.879 13.849 18.364 17.364ZM12 13C13.105 13 14 12.105 14 11 14 9.895 13.105 9 12 9 10.895 9 10 9.895 10 11 10 12.105 10.895 13 12 13Z"></path>
              </svg>
              Checked from: <span x-text="ip_address"></span>
            </span>

            <span class="inline-flex items-center gap-1.5 rounded-md bg-gray-100 px-2.5 py-1 text-gray-600 dark:bg-gray-800 dark:text-gray-400">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                <path d="M17 7C13.571 7 10.645 9.158 9.507 12.19L11.381 12.893C12.234 10.618 14.428 9 17 9C17.698 9 18.369 9.119 18.992 9.339 21.327 10.16 23 12.385 23 15 23 18.314 20.314 21 17 21H7C3.686 21 1 18.314 1 15 1 12.385 2.673 10.16 5.008 9.339 5.003 9.226 5 9.114 5 9 5 5.134 8.134 2 12 2 15.242 2 17.969 4.204 18.765 7.195 18.197 7.068 17.607 7 17 7Z"></path>
              </svg>
              WHOIS: <span :class="domain.whois_ok ? 'text-emerald-500' : 'text-red-600 font-medium'" x-text="domain.whois_expiry || 'N/A'"></span>
            </span>

            <span class="inline-flex items-center gap-1.5 rounded-md bg-gray-100 px-2.5 py-1 text-gray-600 dark:bg-gray-800 dark:text-gray-400">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                <path d="M12 22C6.477 22 2 17.523 2 12 2 6.477 6.477 2 12 2 17.523 2 22 6.477 22 12 22 17.523 17.523 22 12 22ZM13 12V7H11V14H17V12H13ZM11 7H13V13H11V7Z"></path>
              </svg>
              Last checked: <span x-text="domain.timestamp || 'N/A'"></span>
            </span>
          </div>

          <!-- Metrics -->
          <div class="mt-6 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
            <template x-for="metric in domainMetrics(domain)" :key="metric.label">
              <div class="relative w-full rounded-lg border p-6 text-left shadow-sm bg-white dark:bg-[#090E1A] border-gray-200 dark:border-gray-900">
                <dt class="text-sm font-medium text-gray-500 dark:text-gray-500 flex items-center gap-1">
                  <span x-html="metric.icon"></span>
                  <span x-text="metric.label"></span>
                </dt>
                <dd class="text-3xl font-semibold text-gray-900 dark:text-gray-50" x-html="metric.value"></dd>
              </div>
            </template>
          </div>

        </div>
      </div>
    </template>
  </div>

</div>

<small class="mt-auto text-center p-5">⚡ Subscribe via RSS — <a href="index.xml" target="_blank" class="no-underline">to all updates</a></small>
<a class="top-0 right-0 absolute" href="https://github.com/stefanpejcic/domain-monitor"><img loading="lazy" decoding="async" width="149" height="149" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_darkblue_121621.png" class="attachment-full size-full" alt="Fork me on GitHub"></a>
  
<script>
function domainMonitor() {
  return {
    lastUpdated: '',
    domains: [],
    async loadStatus() {
      try {
        const res = await fetch('status.json?_=' + Date.now());
        const data = await res.json();
        this.lastUpdated = data.last_updated;
        this.ip_address = data.ip_address;
        this.domains = data.domains.map(d => ({ ...d, open: false }));
      } catch (err) {
        console.error('Failed to load status.json', err);
      }
    },
    domainMetrics(domain) {
      return [
        {
          label: 'Status code',
          value: domain.http_status || 'N/A',
          icon: `<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M9.999 15.171L19.192 5.979 20.606 7.393 9.999 17.999 3.636 11.636 5.05 10.221 9.999 15.171Z"/></svg>`
        },
        {
          label: 'Response time',
          value: domain.http_response_time_ms !== null ? `${domain.http_response_time_ms.toFixed(0)} ms` : 'N/A',
          icon: `<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M12 22C6.477 22 2 17.523 2 12 2 6.477 6.477 2 12 2 17.523 2 22 6.477 22 12 22 17.523 17.523 22 12 22ZM11 15H13V17H11V15ZM11 7H13V13H11V7Z"/></svg>`
        },
        {
          label: 'IP address',
          value: domain.resolved_ip || 'N/A',
          icon: `<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M17 7C13.571 7 10.645 9.158 9.507 12.19L11.381 12.893C12.234 10.618 14.428 9 17 9C17.698 9 18.369 9.119 18.992 9.339 21.327 10.16 23 12.385 23 15 23 18.314 20.314 21 17 21H7C3.686 21 1 18.314 1 15 1 12.385 2.673 10.16 5.008 9.339 5.003 9.226 5 9.114 5 9 5 5.134 8.134 2 12 2 15.242 2 17.969 4.204 18.765 7.195 18.197 7.068 17.607 7 17 7Z"/></svg>`
        },
        {
          label: 'SSL',
          value: domain.ssl_ok ? domain.ssl_expiry : 'N/A',
          icon: `<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M12 22C6.477 22 2 17.523 2 12 2 6.477 6.477 2 12 2 17.523 2 22 6.477 22 12 22 17.523 17.523 22 12 22ZM11 15H13V17H11V15ZM11 7H13V13H11V7Z"/></svg>`
        },
        {
          label: 'WHOIS',
          value: domain.whois_ok ? domain.whois_expiry : 'N/A',
          icon: `<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M12 22C6.477 22 2 17.523 2 12 2 6.477 6.477 2 12 2 17.523 2 22 6.477 22 12 22 17.523 17.523 22 12 22ZM11 15H13V17H11V15ZM11 7H13V13H11V7Z"/></svg>`
        }
      ];
    }
  }
}
</script>

</body>
</html>
