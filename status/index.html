<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Domain Monitor</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-gray-50 px-6 flex flex-col min-h-screen">

<div class="max-w-5xl w-full mx-auto space-y-10">

<!-- Header -->
<div class="pt-20 flex flex-col items-center">
  <span class="mx-auto inline-flex items-center justify-center rounded-full bg-emerald-100 dark:bg-emerald-400/20 dark:to-emerald-500/10">
    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" aria-hidden="true" class="remixicon text-green size-10 text-emerald-500"><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22ZM17.4571 9.45711L11 15.9142L6.79289 11.7071L8.20711 10.2929L11 13.0858L16.0429 8.04289L17.4571 9.45711Z"></path></svg>
  </span>
  <h1 class="mt-3 text-lg font-semibold text-gray-900 dark:text-gray-50">All services are online</h1>
  <p class="text-sm text-gray-700 dark:text-gray-300">Last updated on <span id="last-updated"></span></p>
</div>

  
<div class="container mx-auto p-6">
  <div id="status-accordion" class="space-y-3"></div>
</div>

<script>
  async function loadStatus() {
    try {
      const res = await fetch("status.json?_=" + Date.now());
      const data = await res.json();
      const accordion = document.getElementById("status-accordion");
      accordion.innerHTML = "";

      data.domains.forEach((d, idx) => {
        let statusColor = d.http_ok ? 'text-emerald-600 dark:text-emerald-500' : 'text-red-600';
        let statusText = d.http_ok ? 'Operational' : 'Down';
        let respTimeClass = "text-gray-500";

        if (d.http_response_time_ms !== null) {
          if (d.http_response_time_ms <= 1000) respTimeClass = "text-green-600";
          else if (d.http_response_time_ms <= 2000) respTimeClass = "text-orange-600 font-medium";
          else respTimeClass = "text-red-600 font-bold";
        }

        accordion.innerHTML += `
          <div class="relative w-full rounded-lg border p-4 text-left shadow-sm bg-white dark:bg-[#090E1A] border-gray-200 dark:border-gray-900">
            <h3 class="flex">
              <button type="button" class="group flex flex-1 cursor-pointer items-center justify-between py-3 text-left focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500 h-12 rounded-lg bg-gray-100 px-4 text-sm font-medium text-gray-900 hover:bg-gray-100/70 dark:bg-gray-800 dark:text-gray-50 hover:dark:bg-gray-800/70"
                      aria-expanded="false"
                      aria-controls="domain-panel-${idx}"
                      onclick="document.getElementById('domain-panel-${idx}').classList.toggle('hidden')">
                <div class="flex w-full items-center justify-between">
                  <span>${d.domain}</span>
                  <span class="mr-6 flex items-center space-x-1 ${statusColor}">
                    <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor" class="shrink-0">
                      <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22ZM17.4571 9.45711L11 15.9142L6.79289 11.7071L8.20711 10.2929L11 13.0858L16.0429 8.04289L17.4571 9.45711Z"></path>
                    </svg>
                    <span class="text-sm">${statusText}</span>
                  </span>
                </div>
              </button>
            </h3>
            <div id="domain-panel-${idx}" class="mt-2 hidden px-4 pb-4 text-sm text-gray-700 dark:text-gray-200 space-y-1">
              <div><strong>WHOIS Expiry:</strong> <span class="${d.whois_ok ? 'text-green-600' : 'text-red-600 font-medium'}">${d.whois_expiry || 'N/A'}</span></div>
              <div><strong>SSL Expiry:</strong> <span class="${d.ssl_ok ? 'text-green-600' : 'text-red-600'}">${d.ssl_expiry || 'N/A'}</span></div>
              <div><strong>HTTP Status:</strong> <span class="${d.http_ok ? 'text-green-600' : 'text-red-600'}">${d.http_status || 'N/A'}</span></div>
              <div><strong>Response Time:</strong> <span class="${respTimeClass}">${d.http_response_time_ms !== null ? d.http_response_time_ms.toFixed(0) + ' ms' : 'N/A'}</span></div>
            </div>
          </div>
        `;
      });

      document.getElementById("last-updated").textContent = data.last_updated;
    } catch (err) {
      console.error("Failed to load status.json", err);
    }
  }

  loadStatus();
</script>



</div>

<small class="mt-auto text-center p-5">⚡ Subscribe via RSS — 
    <a href="index.xml" target="_blank" class="no-underline">to all updates</a>
</small>

  <a class="top-0 right-0 absolute" href="https://github.com/stefanpejcic/domain-monitor">
    <img loading="lazy" decoding="async" width="149" height="149" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_darkblue_121621.png" class="attachment-full size-full" alt="Fork me on GitHub">
  </a>

</body>

</html>
